import os
import numpy as np
import pickle


def predict_action(text):
    action_log_reg = pickle.load(open('pkl/Action_log_reg.pkl', 'rb'))
    action_vectorizer = pickle.load(open('pkl/Action_vectorizer.pkl', 'rb'))
    X = action_vectorizer.transform([text])
    proba = action_log_reg.predict_proba(X)[:, 1]
    return proba

def predict_knowledge(text):
    knowledge_log_reg = pickle.load(open('pkl/Knowledge_log_reg.pkl', 'rb'))
    knowledge_vectorizer = pickle.load(open('pkl/Knowledge_vectorizer.pkl', 'rb'))
    X = knowledge_vectorizer.transform([text])
    proba = knowledge_log_reg.predict_proba(X)[:, 1]
    return proba